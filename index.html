<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SkillsUSA Trivia</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // Lucide icons as inline SVG components
        const Award = (props) => (
            <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="8" r="6"></circle>
                <path d="M15.477 12.89 17 22l-5-3-5 3 1.523-9.11"></path>
            </svg>
        );

        const Trophy = (props) => (
            <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"></path>
                <path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"></path>
                <path d="M4 22h16"></path>
                <path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"></path>
                <path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"></path>
                <path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"></path>
            </svg>
        );

        const CheckCircle = (props) => (
            <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                <polyline points="22 4 12 14.01 9 11.01"></polyline>
            </svg>
        );

        const XCircle = (props) => (
            <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="15" y1="9" x2="9" y2="15"></line>
                <line x1="9" y1="9" x2="15" y2="15"></line>
            </svg>
        );

        const RotateCcw = (props) => (
            <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="1 4 1 10 7 10"></polyline>
                <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path>
            </svg>
        );

        function SkillsUSATrivia() {
            const [currentQuestion, setCurrentQuestion] = useState(0);
            const [score, setScore] = useState(0);
            const [showResult, setShowResult] = useState(false);
            const [selectedAnswer, setSelectedAnswer] = useState(null);
            const [gameOver, setGameOver] = useState(false);
            const [answeredCorrectly, setAnsweredCorrectly] = useState(false);
            const [allQuestions, setAllQuestions] = useState([]);
            const [triviaQuestions, setTriviaQuestions] = useState([]);
            const [isLoadingQuestions, setIsLoadingQuestions] = useState(true);
            const [loadError, setLoadError] = useState(null);

            // GitHub repository configuration - CORRECTED!
            const GITHUB_USER = 'gungrave88th-cmd';
            const GITHUB_REPO = 'skillsusa-trivia';
            const GITHUB_BRANCH = 'main';
            
            const QUESTIONS_URL = `https://raw.githubusercontent.com/${GITHUB_USER}/${GITHUB_REPO}/${GITHUB_BRANCH}/questions.json`;

            // Load questions on mount
            useEffect(() => {
                loadQuestions();
            }, []);

            const loadQuestions = async () => {
                try {
                    setIsLoadingQuestions(true);
                    const response = await fetch(QUESTIONS_URL);
                    if (!response.ok) throw new Error('Failed to load questions');
                    
                    const data = await response.json();
                    // Decode the questions using atob()
                    const decodedQuestions = JSON.parse(atob(data.data));
                    setAllQuestions(decodedQuestions);
                    setTriviaQuestions(getRandomQuestionsFrom(decodedQuestions));
                    setIsLoadingQuestions(false);
                } catch (error) {
                    console.error('Error loading questions:', error);
                    setLoadError('Failed to load questions. Please check your GitHub repository configuration.');
                    setIsLoadingQuestions(false);
                }
            };

            const getRandomQuestionsFrom = (questions) => {
                const shuffled = [...questions].sort(() => Math.random() - 0.5);
                return shuffled.slice(0, 15);
            };

            const handleAnswerClick = (index) => {
                if (showResult) return;
                
                setSelectedAnswer(index);
                setShowResult(true);
                
                if (index === triviaQuestions[currentQuestion].correct) {
                    setScore(score + 1);
                    setAnsweredCorrectly(true);
                } else {
                    setAnsweredCorrectly(false);
                }
            };

            const handleNextQuestion = () => {
                if (currentQuestion + 1 < triviaQuestions.length) {
                    setCurrentQuestion(currentQuestion + 1);
                    setSelectedAnswer(null);
                    setShowResult(false);
                    setAnsweredCorrectly(false);
                } else {
                    setGameOver(true);
                }
            };

            const restartGame = () => {
                setCurrentQuestion(0);
                setScore(0);
                setShowResult(false);
                setSelectedAnswer(null);
                setGameOver(false);
                setAnsweredCorrectly(false);
                setTriviaQuestions(getRandomQuestionsFrom(allQuestions));
            };

            const getScoreMessage = () => {
                const percentage = (score / triviaQuestions.length) * 100;
                if (percentage === 100) return "Perfect Score! You're a SkillsUSA Champion! ðŸ†";
                if (percentage >= 80) return "Excellent! You really know your SkillsUSA! ðŸŒŸ";
                if (percentage >= 60) return "Great job! Keep learning about SkillsUSA! ðŸ‘";
                if (percentage >= 40) return "Good effort! Review SkillsUSA materials to improve! ðŸ“š";
                return "Keep studying! There's more to learn about SkillsUSA! ðŸ’ª";
            };

            // Loading state
            if (isLoadingQuestions) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-600 via-red-600 to-blue-700 flex items-center justify-center p-4">
                        <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full text-center">
                            <Trophy className="w-20 h-20 mx-auto text-yellow-500 mb-4 animate-pulse" />
                            <h2 className="text-2xl font-bold text-gray-800 mb-2">Loading Questions...</h2>
                            <p className="text-gray-600">Please wait while we fetch the trivia questions.</p>
                        </div>
                    </div>
                );
            }

            // Error state
            if (loadError) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-600 via-red-600 to-blue-700 flex items-center justify-center p-4">
                        <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full text-center">
                            <XCircle className="w-20 h-20 mx-auto text-red-500 mb-4" />
                            <h2 className="text-2xl font-bold text-gray-800 mb-2">Error Loading Questions</h2>
                            <p className="text-gray-600 mb-4">{loadError}</p>
                            <p className="text-sm text-gray-500">Make sure questions.json is in your repository.</p>
                        </div>
                    </div>
                );
            }

            if (gameOver) {
                const categoryStats = {};
                triviaQuestions.forEach((q) => {
                    if (!categoryStats[q.category]) {
                        categoryStats[q.category] = { total: 0 };
                    }
                    categoryStats[q.category].total++;
                });

                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-600 via-red-600 to-blue-700 flex items-center justify-center p-4">
                        <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-2xl w-full text-center">
                            <Trophy className="w-24 h-24 mx-auto text-yellow-500 mb-4" />
                            <h1 className="text-4xl font-bold text-gray-800 mb-4">Test Complete!</h1>
                            <div className="bg-blue-50 rounded-lg p-6 mb-6">
                                <p className="text-6xl font-bold text-blue-600 mb-2">{score}/{triviaQuestions.length}</p>
                                <p className="text-xl text-gray-700 mb-4">{getScoreMessage()}</p>
                                <div className="text-left mt-4 space-y-2">
                                    <p className="text-sm font-semibold text-gray-700 mb-2">Questions covered:</p>
                                    {Object.entries(categoryStats).map(([category, stats]) => (
                                        <div key={category} className="flex justify-between text-sm text-gray-600 bg-white px-3 py-1 rounded">
                                            <span>{category}</span>
                                            <span className="font-semibold">{stats.total} {stats.total === 1 ? 'question' : 'questions'}</span>
                                        </div>
                                    ))}
                                </div>
                            </div>
                            <button
                                onClick={restartGame}
                                className="w-full bg-gradient-to-r from-blue-600 to-red-600 text-white px-8 py-4 rounded-lg text-xl font-semibold hover:shadow-lg transform hover:scale-105 transition-all flex items-center gap-2 justify-center"
                            >
                                <RotateCcw className="w-6 h-6" />
                                Take New Test (15 Random Questions)
                            </button>
                        </div>
                    </div>
                );
            }

            const question = triviaQuestions[currentQuestion];

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-600 via-red-600 to-blue-700 flex items-center justify-center p-4">
                    <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-3xl w-full">
                        <div className="flex items-center justify-between mb-6">
                            <div className="flex items-center gap-3">
                                <Award className="w-10 h-10 text-blue-600" />
                                <h1 className="text-3xl font-bold text-gray-800">SkillsUSA Trivia</h1>
                            </div>
                            <div className="text-right">
                                <p className="text-sm text-gray-600">Score</p>
                                <p className="text-2xl font-bold text-blue-600">{score}/{triviaQuestions.length}</p>
                            </div>
                        </div>

                        <div className="mb-6">
                            <div className="flex justify-between text-sm text-gray-600 mb-2">
                                <span>Question {currentQuestion + 1} of {triviaQuestions.length}</span>
                                <span className="bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-xs font-semibold">
                                    {question.category}
                                </span>
                            </div>
                            <div className="w-full bg-gray-200 rounded-full h-3">
                                <div 
                                    className="bg-gradient-to-r from-blue-600 to-red-600 h-3 rounded-full transition-all duration-500"
                                    style={{ width: `${((currentQuestion + 1) / triviaQuestions.length) * 100}%` }}
                                />
                            </div>
                        </div>

                        <div className="mb-8">
                            <h2 className="text-2xl font-semibold text-gray-800 mb-6">
                                {question.question}
                            </h2>

                            <div className="space-y-3">
                                {question.options.map((option, index) => {
                                    const isCorrect = index === question.correct;
                                    const isSelected = selectedAnswer === index;
                                    
                                    let buttonClass = "w-full text-left p-4 rounded-lg border-2 transition-all ";
                                    
                                    if (!showResult) {
                                        buttonClass += "border-gray-300 hover:border-blue-500 hover:bg-blue-50 cursor-pointer";
                                    } else {
                                        if (isCorrect) {
                                            buttonClass += "border-green-500 bg-green-50";
                                        } else if (isSelected && !isCorrect) {
                                            buttonClass += "border-red-500 bg-red-50";
                                        } else {
                                            buttonClass += "border-gray-300 bg-gray-50";
                                        }
                                    }

                                    return (
                                        <button
                                            key={index}
                                            onClick={() => handleAnswerClick(index)}
                                            disabled={showResult}
                                            className={buttonClass}
                                        >
                                            <div className="flex items-center justify-between">
                                                <span className="text-lg font-medium text-gray-800">{option}</span>
                                                {showResult && isCorrect && (
                                                    <CheckCircle className="w-6 h-6 text-green-600" />
                                                )}
                                                {showResult && isSelected && !isCorrect && (
                                                    <XCircle className="w-6 h-6 text-red-600" />
                                                )}
                                            </div>
                                        </button>
                                    );
                                })}
                            </div>
                        </div>

                        {showResult && (
                            <div className="mb-6">
                                {answeredCorrectly ? (
                                    <div className="bg-green-50 border-2 border-green-500 rounded-lg p-4 flex items-center gap-3">
                                        <CheckCircle className="w-8 h-8 text-green-600 flex-shrink-0" />
                                        <div>
                                            <p className="font-semibold text-green-800 text-lg">Correct!</p>
                                            <p className="text-green-700">Great job! You got it right!</p>
                                        </div>
                                    </div>
                                ) : (
                                    <div className="bg-red-50 border-2 border-red-500 rounded-lg p-4 flex items-center gap-3">
                                        <XCircle className="w-8 h-8 text-red-600 flex-shrink-0" />
                                        <div>
                                            <p className="font-semibold text-red-800 text-lg">Incorrect</p>
                                            <p className="text-red-700">
                                                The correct answer is: <strong>{question.options[question.correct]}</strong>
                                            </p>
                                        </div>
                                    </div>
                                )}
                            </div>
                        )}

                        {showResult && (
                            <button
                                onClick={handleNextQuestion}
                                className="w-full bg-gradient-to-r from-blue-600 to-red-600 text-white py-4 rounded-lg text-xl font-semibold hover:shadow-lg transform hover:scale-105 transition-all"
                            >
                                {currentQuestion + 1 === triviaQuestions.length ? "See Results" : "Next Question"}
                            </button>
                        )}
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<SkillsUSATrivia />);
    </script>
</body>
</html>
